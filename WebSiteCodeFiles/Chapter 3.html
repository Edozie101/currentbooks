<HTML><HEAD><TITLE>Chapter 3 (equations) functions</TITLE></HEAD><BODY><H2 ALIGN="center">Functions for cast member "Chapter 3 (equations)" of castlib "math"</H2><P><PRE><KBD><A NAME="solveSimultaneous"> </A>on solveSimultaneous (simul)<BR> --! ARGUMENTS: simul (a list of n lists, where each list has length n+1 and represents a linear equation with n variables)<BR> --! RETURNS: a list of n values representing the solution, or #error if there is no unique solution<BR> set orig to duplicate(simul)<BR> -- set redux to an empty array<BR> set redux to &#091;&#093;<BR> -- set n to the number of equations<BR> set n to simul.count<BR> -- repeat for each equation number i, working backwards through the list<BR> repeat with i=n down to 1<BR> -- set row to an equation with a non-zero element in the i'th position, up to and including the current equation<BR> repeat with j=i down to 1<BR> if simul&#091;j&#093;&#091;i&#093; &#060;&#062; 0 then<BR> set row=simul&#091;j&#093; <BR> exit repeat<BR> end if<BR> end repeat<BR> -- if no such row found then there is no unique solution<BR> if j=0 then return #error<BR> -- divide row by this non-zero element<BR> set row to row/float(row&#091;i&#093;)<BR> -- append this row to redux<BR> redux.add(row)<BR> -- delete this row from simul<BR> simul.deleteat(j)<BR> -- for each other row in simul up to and including equation (i-1) (remember that one row has been deleted now)<BR> repeat with j=i-1 down to 1<BR> -- if the row has a non-zero element in the i'th position then subtract a multiple of row by this element, <BR> -- getting an equation with zero in this position.<BR> if simul&#091;j&#093;&#091;i&#093;&#060;&#062;0 then<BR> set simul&#091;j&#093; to simul&#091;j&#093;-row*simul&#091;j&#093;&#091;i&#093;<BR> end if<BR> end repeat<BR> end repeat<BR> -- Now redux is a triangular set of equations, work back from the simplest, with just one variable:<BR> -- set output to an array with n elements<BR> set output to &#091;&#093;<BR> set output&#091;n&#093; to 0<BR> -- for each equation number i in redux, working backwards<BR> repeat with i=n down to 1<BR> -- set sum to the sum of all multiples of the variables from i+1 to n with their coefficients in the equation<BR> set sum to 0<BR> set ind to n+1-i<BR> repeat with j=1 to ind-1<BR> set sum to sum + redux&#091;i&#093;&#091;j&#093;*output&#091;j&#093;<BR> end repeat<BR> -- subtract sum from the n+1'th element to obtain the i'th element<BR> set output&#091;ind&#093; to redux&#091;i&#093;&#091;n+1&#093;-sum<BR> end repeat<BR> -- output is then the required list<BR> -- double-check to see if integer answer will solve the equations<BR> set test to &#091;&#093;<BR> repeat with o in output<BR> test.add(integer(o))<BR> end repeat<BR> repeat with r in orig<BR> set sum to 0<BR> repeat with i=1 to n<BR> set sum to sum+test&#091;i&#093;*r&#091;i&#093;<BR> end repeat<BR> if sum&#060;&#062;r&#091;n+1&#093; then return output<BR> end repeat<BR> return test<BR>end<BR><HR><A NAME="solveQuadratic"> </A>on solveQuadratic (b, c, a, db)<BR> --! ARGUMENTS: b, c, a (all numbers), db (boolean). <BR> --! a is optional (default is 1); db also optional (default is FALSE)<BR> --! RETURNS: the list of solutions to ax^2 +bx+c=0 (if db is false) or ax^2+2bx+c=0<BR> if voidp(a) then set a to 1<BR> if a=0 then <BR> if not db then return &#091;-c/float(b)&#093;<BR> return &#091;-c/(b*2.0)&#093;<BR> end if<BR> if not db then set b to b*2<BR> set disc to b*b-a*c<BR> set sq to sqrt(float(disc))<BR> return &#091;(-b-sq)/a,(-b+sq)/a&#093;<BR>end<BR><HR><A NAME="solveCubic"> </A>on solveCubic(a,b,c,d)<BR> --! ARGUMENTS: a, b, c, d (all numbers). d is optional (default is 1)<BR> --! RETURNS: the list of solutions to dx^3+ax^2+bx+c=0<BR> <BR> -- if d is defined then divide a, b and c by d <BR> if not voidp(d) then<BR> if d=0 then return <A HREF="Chapter 3.html#solveQuadratic">solveQuadratic</A>(b,c,a)<BR> set d to float(d)<BR> set a to a/d<BR> set b to b/d<BR> set c to c/d<BR> else<BR> set a to float(a)<BR> set b to float(b)<BR> set c to float(c)<BR> end if<BR> <BR> set p to b/3 - a*a/9<BR> set q to a*a*a/27 - a*b/6 + c/2<BR> set disc to p*p*p + q*q<BR> <BR> if abs(disc)&#060;0.001 then <BR> set r to <A HREF="Chapter 2.html#cuberoot">cuberoot</A>(-q)<BR> set ret to &#091;2*r, -r&#093;<BR> else if disc&#062;0 then<BR> set r to <A HREF="Chapter 2.html#cuberoot">cuberoot</A>(-q+sqrt(disc))<BR> set s to <A HREF="Chapter 2.html#cuberoot">cuberoot</A>(-q-sqrt(disc))<BR> set ret to &#091;r+s&#093;<BR> else<BR> <BR> set ang to <A HREF="2D vectors.html#acos">acos</A>(-q/sqrt(-p*p*p))<BR> set r to 2*sqrt(-p)<BR> set ret to &#091;&#093;<BR> repeat with k=-1 to 1<BR> set theta to (ang - 2*pi*k)/3<BR> ret.add(r*cos(theta))<BR> end repeat<BR> end if<BR> set ret to ret-a/3 --NB: this adds the value to each element<BR> return ret<BR>end <BR><HR></KBD><P><A HREF="math index.html">Back to index</A></PRE></BODY></HTML> 