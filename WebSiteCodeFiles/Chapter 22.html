<HTML><HEAD><TITLE>Chapter 22 (optimization) functions</TITLE></HEAD><BODY><H2 ALIGN="center">Functions for cast member "Chapter 22 (optimization)" of castlib "math"</H2><P><PRE><KBD><A NAME="drawBresenham"> </A>on drawBresenham(startCoords, endCoords, im)<BR> --! ARGUMENTS: startCoords, endCoords (2d vectors), im (optional image object to draw into)<BR> --! RETURNS: the image object with the line drawn<BR> <BR> set x to startCoords&#091;1&#093;<BR> set y to startCoords&#091;2&#093;<BR> set b to endCoords&#091;1&#093;-x <BR> if b&#060;0 then -- draw from left to right<BR> return drawBresenham(endCoords,startCoords, im)<BR> end if<BR> <BR> set a to endCoords&#091;2&#093;-y<BR> if abs(a)&#062;abs(b) then -- switch x and y<BR> return <A HREF="Chapter 22.html#drawVertBresenham">drawVertBresenham</A>(startCoords, endCoords, im)<BR> end if<BR> <BR> if a&#062;0 then -- switch to negative gradient<BR> set a to -a<BR> set m to -1<BR> else<BR> set m to 1<BR> end if<BR> <BR> set d to 2*(b+a)<BR> set e to 2*a<BR> <BR> -- set up image<BR> if voidp(im) then <BR> img=image(200,200,16)<BR> else<BR> img=im<BR> end if<BR> img.setPixel(startCoords,rgb(0,255,0)) <BR> -- calculate 2L(P1)<BR> set linefn to -b-2*a<BR> -- perform iteration<BR> repeat with x=x+1 to endcoords&#091;1&#093;<BR> if linefn&#060;=0 then -- move diagonally<BR> set y to y-m<BR> set linefn to linefn+d<BR> else -- move right<BR> set linefn to linefn+e<BR> end if<BR> img.setPixel(x,y,rgb(0,0,0))<BR> end repeat<BR> img.setPixel(endcoords,rgb(255,0,0))<BR> return img<BR>end <BR><HR><A NAME="drawVertBresenham"> </A>on drawVertBresenham(startCoords, endCoords, im) <BR> --! ARGUMENTS: startCoords, endCoords (2d vectors), im (optional image object to draw into)<BR> --! RETURNS: the image object with the line drawn.<BR> --! NB: specifically for lines where dx&#060;dy<BR> --! only to be called through <A HREF="Chapter 22.html#drawBresenham">drawBresenham</A> - no error checking<BR> <BR> set x to startCoords&#091;1&#093;<BR> set y to startCoords&#091;2&#093;<BR> set b to endCoords&#091;1&#093;-x <BR> set a to endCoords&#091;2&#093;-y<BR> if a&#060;0 then -- draw from top to bottom<BR> return drawVertBresenham(endCoords,startCoords, im)<BR> end if<BR> <BR> if b&#062;0 then -- switch to negative gradient<BR> set b to -b<BR> set m to -1<BR> else<BR> set m to 1<BR> end if<BR> <BR> set d to 2*(b+a)<BR> set e to 2*b<BR> <BR> -- set up image<BR> if voidp(im) then <BR> img=image(200,200,16)<BR> else<BR> img=im<BR> end if<BR> img.setPixel(startCoords,rgb(0,255,0)) <BR> -- calculate 2L(P1)<BR> set linefn to -2*b-a<BR> -- perform iteration<BR> repeat with y=y+1 to endcoords&#091;2&#093;<BR> if linefn&#060;=0 then -- move diagonally<BR> set x to x-m<BR> set linefn to linefn+d<BR> else -- move right<BR> set linefn to linefn+e<BR> end if<BR> img.setPixel(x,y,rgb(0,0,0))<BR> end repeat<BR> img.setPixel(endcoords,rgb(255,0,0))<BR> return img<BR>end <BR><HR></KBD><P><A HREF="math index.html">Back to index</A></PRE></BODY></HTML> 