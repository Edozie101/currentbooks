<HTML><HEAD><TITLE>matrices functions</TITLE></HEAD><BODY><H2 ALIGN="center">Functions for cast member "matrices" of castlib "math"</H2><P><PRE><KBD><A NAME="determinant"> </A>on determinant(m)<BR> --! ARGUMENTS: m (a 2-dimensional list representing a square matrix)<BR> --! RETURNS: the determinant of the matrix<BR> <BR> set size to m.count<BR> -- if the matrix is 1x1 then return the only element (bottom of recursion)<BR> if size=1 then return m&#091;1&#093;&#091;1&#093; <BR> -- otherwise<BR> set mult to 1<BR> set sum to 0<BR> -- for each column i of the matrix<BR> repeat with i=1 to size<BR> -- take the i'th element el of the first row<BR> set el to m&#091;1&#093;&#091;i&#093;<BR> -- create the square matrix formed of the remaining rows and all columns except i<BR> set newmatrix to &#091;&#093;<BR> repeat with j=2 to size<BR> set row to m&#091;j&#093;.duplicate()<BR> row.deleteat(i)<BR> newmatrix.add(row)<BR> end repeat<BR> -- calculate the determinant of this matrix, multiply by el, and alternately add or subtract from a running total <BR> set sum to sum+ el*mult*determinant(newmatrix) <BR> set mult to -mult<BR> end repeat<BR> return sum<BR>end <BR><HR><A NAME="matrixMultiply"> </A>on matrixMultiply (l, m)<BR> --! ARGUMENTS: l, m (2-dimensional lists representing two matrices of appropriate sizes)<BR> --! RETURNS: a new matrix l*m<BR> <BR> -- create an empty matrix<BR> set n to &#091;&#093;<BR> -- for each row i of l<BR> repeat with i=1 to l.count<BR> -- create an empty list <BR> set r to &#091;&#093;<BR> -- for each column j of m<BR> repeat with j=1 to m&#091;1&#093;.count<BR> -- sum the products of l row i and m column j<BR> set sum to 0<BR> repeat with k=1 to m.count<BR> set sum to sum + l&#091;i&#093;&#091;k&#093;*m&#091;k&#093;&#091;j&#093; <BR> end repeat<BR> -- append this sum to r<BR> r.add(sum)<BR> end repeat<BR> -- now append this list to n<BR> n.add(r)<BR> end repeat<BR> -- return the completed product matrix<BR> return n<BR>end <BR><HR><A NAME="inverseMatrix"> </A>on inverseMatrix (m)<BR> --! ARGUMENTS: m (a 2-dimensional list representing a square matrix)<BR> --! RETURNS: the inverse of the matrix<BR> <BR> if <A HREF="matrices.html#determinant">determinant</A>(m)=0 then return #none<BR> set size to m.count<BR> <BR> -- create identity matrix of the appropriate size<BR> set inv to &#091;&#093;<BR> repeat with i=1 to size<BR> set r to &#091;&#093;<BR> repeat with j=1 to size<BR> if i=j then r.add(1)<BR> else r.add(0)<BR> end repeat<BR> inv.add(r)<BR> end repeat<BR> <BR> -- repeat for each row number i, working backwards through the list<BR> repeat with i=size down to 1<BR> -- set j to a row with a non-zero element in the i'th position, up to and including the current equation<BR> -- (there is always such a row because the <A HREF="matrices.html#determinant">determinant</A> is non-zero)<BR> repeat with j=i down to 1<BR> if m&#091;j&#093;&#091;i&#093; &#060;&#062; 0 then<BR> exit repeat<BR> end if<BR> end repeat<BR> -- if j is less than i then add this row to the i'th row, for both matrices<BR> if j&#060;i then<BR> set inv&#091;i&#093; to inv&#091;i&#093;+inv&#091;j&#093;<BR> set m&#091;i&#093; to m&#091;i&#093;+m&#091;j&#093;<BR> end if<BR> <BR> -- divide this row by the non-zero element, for both matrices<BR> set inv&#091;i&#093; to inv&#091;i&#093;/float(m&#091;i&#093;&#091;i&#093;)<BR> set m&#091;i&#093; to m&#091;i&#093;/float(m&#091;i&#093;&#091;i&#093;)<BR> -- for each other row in m <BR> repeat with j=size down to 1<BR> if j=i then next repeat<BR> -- if the row has a non-zero element in the i'th position then subtract the product of row i with this element, <BR> -- getting a row with zero in this position.<BR> if m&#091;j&#093;&#091;i&#093;&#060;&#062;0 then<BR> set inv&#091;j&#093; to inv&#091;j&#093;-inv&#091;i&#093;*m&#091;j&#093;&#091;i&#093;<BR> set m&#091;j&#093; to m&#091;j&#093;-m&#091;i&#093;*m&#091;j&#093;&#091;i&#093;<BR> end if<BR> end repeat<BR> end repeat<BR> return inv<BR>end<BR><HR></KBD><P><A HREF="math index.html">Back to index</A></PRE></BODY></HTML> 