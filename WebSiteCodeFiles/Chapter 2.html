<HTML><HEAD><TITLE>Chapter 2 (fractions, primes and arithmetic) functions</TITLE></HEAD><BODY><H2 ALIGN="center">Functions for cast member "Chapter 2 (fractions, primes and arithmetic)" of castlib "math"</H2><P><PRE><KBD><A NAME="addfractions"> </A>on addfractions (f1,f2)<BR> --! ARGUMENTS: f1, f2 (2-element lists of integers representing fractions)<BR> --! RETURNS: a list of the numerator and denominator of the fraction sum<BR> set num1 to f1&#091;1&#093;<BR> set den1 to f1&#091;2&#093;<BR> set num2 to f2&#091;1&#093;<BR> set den2 to f2&#091;2&#093;<BR> -- if the denominators are equal then return the fraction with that denominator<BR> -- and the sum of the numerators<BR> if den1 = den2 then <BR> return &#091;num1+num2, den1&#093;<BR> else<BR> -- otherwise return the fraction with the numerator (n1*d2+d2*n1) and denominator (d1*d2)<BR> set num3 = num1*den2<BR> set num4 = num2*den1 <BR> return &#091;num3+num4,den1*den2&#093;<BR> end if<BR>end <BR><HR><A NAME="listOfPrimes"> </A>on listOfPrimes (M)<BR> --! ARGUMENTS: M (an integer)<BR> --! RETURNS: a list of all primes up to M<BR> -- make an array with all the numbers from 2 to M and call it nlist<BR> set nlist to &#091;&#093;<BR> repeat with i=2 to M<BR> nlist.add(i)<BR> end repeat<BR> <BR> -- set maxM to the largest integer less than the square root of M<BR> set maxM to <A HREF="numerical utilities.html#floor">floor</A>(sqrt(M))<BR> <BR> set i to 1<BR> -- repeat while the index'th element of nlist is less than maxM<BR> repeat while nlist&#091;i&#093;&#060;maxM<BR> set p to nlist&#091;i&#093;<BR> -- delete each element in nlist beyond the index that is divisible by the index'th element<BR> repeat with i2 = nlist.count down to i+1<BR> if nlist&#091;i2&#093; mod p=0 then nlist.deleteat(i2)<BR> end repeat<BR> -- add 1 to the index<BR> i=i+1<BR> end repeat<BR> -- return the remaining list<BR> return nlist<BR>end <BR><HR><A NAME="primeFactors"> </A>on primeFactors (n)<BR> --! ARGUMENTS: n (an integer)<BR> --! RETURNS: the list of all prime factors of n (by a silly method)<BR> -- create a list plist of possible primes (up to n/2)<BR> set plist to <A HREF="Chapter 2.html#listOfPrimes">listOfPrimes</A>(<A HREF="numerical utilities.html#floor">floor</A>(n/2))<BR> -- set rlist to a blank array<BR> set rlist to &#091;&#093;<BR> <BR> set i to 1<BR> -- repeat while index&#060;= the number of elements in plist<BR> repeat while i &#060;= plist.count<BR> -- if n is divisible by the index'th element of plist <BR> set p to plist&#091;i&#093;<BR> if n mod p =0 then<BR> -- divide n by p and append p to plist<BR> set n = n/p<BR> rlist.add(p)<BR> -- otherwise increase index by 1<BR> else<BR> set i to i+1<BR> end if<BR> end repeat<BR> -- now return the list<BR> return rlist<BR>end<BR><HR><A NAME="gcd"> </A>on gcd(n, m)<BR> --! ARGUMENTS: n, m (integers greater than 0)<BR> --! RETURNS: the greatest common divisor of n and m<BR> --set r to the remainder of n/m<BR> set r to n mod m<BR> -- if r=0 then n is divisible by m so return m<BR> if r = 0 then <BR> return m<BR> -- otherwise return the gcd of m and r<BR> else <BR> return gcd(m, r)<BR> end if<BR>end <BR><HR><A NAME="strictModulo"> </A>on strictModulo (n, m)<BR> --! ARGUMENTS: n, m (integers)<BR> --! RETURNS: n mod m (the positive remainder when dividing n by m)<BR> -- set r to mod (n,m)<BR> set r to n mod m<BR> -- if r is negative then add m to r<BR> if r&#060;0 then return r + m<BR> -- return r<BR> return r<BR>end <BR><HR><A NAME="mthRoot"> </A>on mthRoot (n, m)<BR> --! ARGUMENTS: n (integer or float), m (integer)<BR> --! RETURNS: the m'th root of n if it exists, or #error if not<BR> -- if n is negative then<BR> if n&#060;0 then<BR> -- set p to the mth root of -n<BR> set p to power(-n, 1.0/m)<BR> -- if (-p)^m is close to n then return -p<BR> if abs(power(-p, m)-n)&#060;0.1 then <BR> return -p<BR> -- otherwise there is no answer<BR> else<BR> return #error<BR> end if<BR> else<BR> -- if n is positive then just return the mth root of n<BR> return power(n,1.0/m)<BR> end if<BR>end <BR><HR><A NAME="cuberoot"> </A>on cuberoot m<BR> --! ARGUMENTS: m (a number)<BR> --! RETURNS: cube root of m<BR> if m=0 then return 0<BR> if m&#062;0 then return power(m, 1/3.0)<BR> return -power(-m,1/3.0)<BR>end<BR><HR></KBD><P><A HREF="math index.html">Back to index</A></PRE></BODY></HTML> 